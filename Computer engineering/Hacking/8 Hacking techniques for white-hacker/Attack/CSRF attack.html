<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>White-hacker, Web security</title>
</head>
<body>
  <header>
    <h1><a href="../8 Hack Techniques.html" title="8 Hack Techniques">8 Hacking techniques for white-hacker</a></h1>
  </header>
  <nav>
    <h2>Category</h2>

    <ol>
      <li><a href="../White-hacker, Web security.html">White-hacker, Web security</a></li>
      <li>Attack</li>
      <ul style="margin-left:-20px">
        <li><a href="Brute force.html">Brute force attack</a></li>
        <li><a href="Comand injection attack.html">Comand injection attack</a></li>
        <li><a href="CSRF attack.html">CSRF attack</a></li>
        <li><a href="File inclusion.html">File inclusion</a></li>
        <li><a href="File upload.html">File upload</a></li>
        <li><a href="CAPTCHA attack.html">CAPTCHA attack</a></li>
        <li><a href="SQL injection.html">SQL injection</a></li>
      </ul>
    </ol>
  </nav>

  <article>
    <h2>CSRF attack</h2>

    <ol>
      <li>정의 : 해커가 유저에게 피싱을 하고 유저가 링크를 클릭하면 사용자 그룹에서 어떠한 기능을 실행하여 패스워드 변조 같은 해킹을 하는 방법이다.</li>

      <li style="padding-top:10px">필수조건 : 유저가 피싱을 당하여 링크를 누른 시점에 사이트가 로그인 되어 있어야 한다.
        <ul style="margin-left:-20px">
          <li>만약 로그인 되어 있지 않다면 적절한 쿠키가 생성되지 않아서 공격에 실패한다.</li>
        </ul>
      </li>

      <li style="padding-top:10px">Html폼 보단 javascript(Ajax)를 이용해서 피싱할 링크(사이트)를 만드는 것이 사용자를 속이기 더 쉽다.</li>

      <li style="padding-top:10px">Referer헤더 : 어떤 요청이 전송될 때 이전의 어떤 경로로부터 요청 되었는지 알려주기 위해서 웹 브라우저에서 자동으로 설정하는 헤더다.
        <ul style="margin-left:-20px">
          <li>개발자 입장에서는 이 Referer 주소가 서버 주소와 동일한지 여부를 따져서 정상적인 경로로 요청이 왔는지 확인한다. 만약 이 값이 틀리다면 이것을 차단 함으로써 CSRF를 어느정도 막을 수 있다.</li>
            <ul style="margin-left:-20px">
                <li>만약 CSRF 공격이 해커 사이트가 아니라 웹 서버 자체에서 실행이 된다면 웹 서버 주소로 설정되기 때문에 위의 대응을 우회할 수 있다.</li>
            </ul>
          <li>eregi 함수를 사용할 때도 주의해야 한다. 이 함수를 사용해서 서버 주소가 맞는지 여부를 판단한다면, 해커가 해커사이트 주소에 서버 주소를 덧 붙여서 공격한다면 우회가 가능하다.</li>
            <ul style="margin-left:-20px">
              <li>즉, 제대로 검사를 하려면 처음부터 끝까지 다 검사해줘야 한다.</li>
            </ul>
        </ul>
      </li>

      <li style="padding-top:10px">CSRF 토큰을 검사함으로써 CSRF 공격을 막을 수 있다. CSRF 토큰은 시시각각 변하기 때문에 해커가 예측해서 공격하기 힘들다. 하지만, Ajax를 이용하여 자동으로 토큰을 탈취할 수 있다. 이것을 XSS(Stored)를 이용하여 사이트에 삽입하고 유저가 이 사이트를 열게 되면 script가 실행되게 끔 해서 CSRF 대응을 우회할 수가 있다.</li>

      <li style="padding-top:10px">대응
        <ul style="margin-left:-20px">
          <li>현재 패스워드 변경 시 현재 패스워드를 입력하게 함으로써 막을 수 있다.</li>
          <li>Captcha를 이용하여 유저가 직접 요청을 수행하는지를 확인하는 것도 있다.</li>
        </ul>
      </li>
    </ol>
  </article>
</body>
</html>
